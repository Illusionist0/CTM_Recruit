{"version":3,"sources":["uni-app:///main.js","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?467d","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?8f9f","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?c19d","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?ed0e","uni-app:///pages/user/service/robot.vue","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?9a54","webpack:////Users/mac/Documents/HBuilderProjects/CTM/pages/user/service/robot.vue?f793"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","computed","data","msgLoad","anData","animationData","showTow","msgList","my","msg","type","questionList","go","srcollHeight","list","query","page","limit","ifCommon","query2","totalPage","onLoad","onPullDownRefresh","console","methods","getChatAskList","res","getRobotLogList","addRobotLog","switchAsks","initView","uni","select","boundingClientRect","mgUpHeight","exec","l","wh","goPag","msgMove","duration","timingFunction","animation","msgGo","setTimeout","answer","sendMsg","msgKf","ask","ckAdd","contactUs","route","hideKey","upTowmn"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAk1B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACuGt2B;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA,eAEA;EACAC,0CACA,oCACA,oCACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACA;MACA;MACAC;QAAAC;QAAAC;QAAAC;QAAAC;MAAA;MACAF;MACAG;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAH;QACAC;MACA;MACAG;MACAT;IACA;EACA;EAEAU;IACA;IACA;IACA;EACA;EAEAC;IACAC;IACA;IACA;EACA;EAEAC;IACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACAH;gBACA;kBACA;kBACA;kBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAI;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAGA;cAAA;gBAAAD;gBACAH;gBACA;kBACArB;kBACAA;kBACA;kBACA;kBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;AACA;AACA;IACA0B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAF;gBACAH;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAM;MACA;QACA;MACA;QACA;MACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACA;MACAC;QACA;QACAhB,MACAiB,eACAC;UACA;UACA;UACAV;UACA;YACA;YACA;YACA;YACAW;UACA;UACA;UACA;YACA;UACA;QACA,GACAC;MACA;MACA;MAEAC;MACAC;MACA;IACA;IAEA;IACAC;MACA;MACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACAC;QACAC;MACA;MAEA;MAEAC;MAEA;IACA;IACA;IACAC;MAAA;MACA;MACA;MACAC;QACA;QACA7B,MACAiB,eACAC;UACA;UACA;YACA;UACA;UACA;UACA;UACA;UACA;YACA;YACA;cACA;YACA;cACA;cACA;YACA;UACA;QACA,GACAE;MACA;IACA;IACA;IACAU;MACAtB;MACA;QACAf;QACAC;QACAC;MACA;MACA;MACA;MACA;QACAF;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAoC;MACA;MACA;QACA;MACA;MACA;MACA;QAAArC;QAAAD;MAAA;MACA;QACAA;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAqC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACAxB;gBAAA;gBAAA,OACA;kBAAAyB;gBAAA;cAAA;gBAAAtB;gBACAH;gBACA;kBACAqB;oBACA;oBACA;oBACA;sBACApC;sBACAC;sBACAC;sBACAC;oBACA;oBACA;sBACAH;sBACAC;sBACAC;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;kBACA;gBACA;kBACA;kBACA;oBACAF;oBACAC;oBACAC;kBACA;gBACA;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAuC;MACA;QACA;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;QACAC;MACA;IACA;IAEAC;MACArB;IACA;IACA;IACAsB;MACA;QACAb;QACAC;MACA;MAEA;MAEAC;MAEA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AClZA;AAAA;AAAA;AAAA;AAA6jD,CAAgB,k6CAAG,EAAC,C;;;;;;;;;;;ACAjlD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/user/service/robot.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/user/service/robot.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./robot.vue?vue&type=template&id=4f5fcd85&\"\nvar renderjs\nimport script from \"./robot.vue?vue&type=script&lang=js&\"\nexport * from \"./robot.vue?vue&type=script&lang=js&\"\nimport style0 from \"./robot.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/user/service/robot.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./robot.vue?vue&type=template&id=4f5fcd85&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./robot.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./robot.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<!-- 空盒子用来防止消息过少时 拉起键盘会遮盖消息 -->\r\n\t\t<view :animation=\"anData\" style=\"height:0;\"></view>\r\n\t\t<!-- 消息体 -->\r\n\t\t<scroll-view scroll-with-animation scroll-y=\"true\" @touchmove=\"hideKey\" style=\"width: 750rpx;\" :style=\"{ height: srcollHeight }\" :scroll-top=\"go\">\r\n\t\t\t<!-- 用来获取消息体高度 -->\r\n\t\t\t<view id=\"okk\" scroll-with-animation>\r\n\t\t\t\t<!-- 消息 -->\r\n\t\t\t\t<view class=\"flex-column-start\" v-for=\"(x, i) in msgList\" :key=\"i\">\r\n\t\t\t\t\t<!-- 用户消息 头像可选加入-->\r\n\t\t\t\t\t<view v-if=\"x.my\" class=\"flex justify-end padding-right one-show  align-start  padding-top\">\r\n\t\t\t\t\t\t<!-- \t<image v-if=\"!x.my\" class=\"chat-img\" src=\"../../static/...\" mode=\"aspectFill\" ></image> -->\r\n\t\t\t\t\t\t<view class=\"flex justify-end\" style=\"width: 400rpx;\">\r\n\t\t\t\t\t\t\t<view class=\"margin-left padding-chat bg-cyan\" style=\"border-radius: 35rpx;\">\r\n\t\t\t\t\t\t\t\t<text style=\"word-break: break-all;\">{{ x.msg }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<!-- <image class=\"chat-img margin-left\" src=\"../../static/...\" mode=\"aspectFill\" ></image> -->\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- 机器人消息 -->\r\n\t\t\t\t\t<view v-if=\"!x.my\" class=\"flex-row-start margin-left margin-top one-show\">\r\n\t\t\t\t\t\t<view class=\"chat-img flex-row-center\"><image style=\"height: 75rpx;width: 75rpx;\" src=\"../../../static/img/robt.png\" mode=\"aspectFit\"></image></view>\r\n\t\t\t\t\t\t<view class=\"flex\" style=\"width: 500rpx;\">\r\n\t\t\t\t\t\t\t<view class=\"margin-left padding-chat flex-column-start\" style=\"border-radius: 35rpx;background-color: #f9f9f9;\">\r\n\t\t\t\t\t\t\t\t<text style=\"word-break: break-all;\">{{ x.msg }}</text>\r\n\t\t\t\t\t\t\t\t<!-- 消息模板 =>初次问候 -->\r\n\t\t\t\t\t\t\t\t<view class=\"flex-column-start\" v-if=\"x.type == 1\" style=\"color: #2fa39b;\">\r\n\t\t\t\t\t\t\t\t\t<text style=\"color: #838383;font-size: 22rpx;margin-top: 15rpx;\">您可以这样问我:</text>\r\n\t\t\t\t\t\t\t\t\t<text @click=\"answer(item)\" style=\"margin-top: 10upx;\" v-for=\"(item, index) in x.questionList\" :key=\"index\">{{ item.ask }}</text>\r\n\t\t\t\t\t\t\t\t\t<view class=\"flex-row-between  padding-top-sm\" v-if=\"totalPage > 1\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"my-neirong-sm\">没有您要的答案?</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"padding-left\" style=\"color: #12ae85;\" @click=\"switchAsks\">换一批</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<!-- 消息模板 =>多个答案 -->\r\n\t\t\t\t\t\t\t\t<view class=\"flex-column-start\" v-if=\"x.type == 2\" style=\"color: #2fa39b;\">\r\n\t\t\t\t\t\t\t\t\t<text style=\"color: #838383;font-size: 22rpx;margin-top: 15rpx;\">猜您想问:</text>\r\n\t\t\t\t\t\t\t\t\t<!-- 连接服务器应该用item.id -->\r\n\t\t\t\t\t\t\t\t\t<text @click=\"answer(item)\" style=\"margin-top: 30rpx;\" v-for=\"(item, index) in x.questionList\" :key=\"index\">{{ item.ask }}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<!-- 消息模板 => 无法回答-->\r\n\t\t\t\t\t\t\t\t<!-- <view class=\"flex-column-start\" v-if=\"x.type == 0\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"padding-top-sm\" style=\"color: #2fa39b;\">提交意见与反馈</text>\r\n\t\t\t\t\t\t\t\t\t<text style=\"color: #838383;font-size: 22rpx;margin-top: 15rpx;\">下面是一些常见问题,您可以点击对应的文字快速获取答案:</text>\r\n\t\t\t\t\t\t\t\t\t<text @click=\"answer(item)\" style=\"margin-top: 30rpx;color: #2fa39b;\" v-for=\"(item, index) in x.questionList\" :key=\"index\">{{ item.ask }}</text>\r\n\t\t\t\t\t\t\t\t\t<view class=\"flex-row-between  padding-top-sm\" v-if=\"totalPage>1\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"my-neirong-sm\">没有您要的答案?</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"padding-left\" style=\"color: #1396c5;\" @click=\"switchAsks\">换一批</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- loading是显示 -->\r\n\t\t\t\t<view v-show=\"msgLoad\" class=\"flex-row-start margin-left margin-top\">\r\n\t\t\t\t\t<view class=\"chat-img flex-row-center\"><image style=\"height: 75rpx;width: 75rpx;\" src=\"../../../static/img/robt.png\" mode=\"aspectFit\"></image></view>\r\n\t\t\t\t\t<view class=\"flex\" style=\"width: 500rpx;\">\r\n\t\t\t\t\t\t<view class=\"margin-left padding-chat flex-column-start\" style=\"border-radius: 35rpx;background-color: #f9f9f9;\">\r\n\t\t\t\t\t\t\t<view class=\"cuIcon-loading turn-load\" style=\"font-size: 35rpx;color: #3e9982;\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- 防止消息底部被遮 -->\r\n\t\t\t\t<view style=\"height: 120rpx;\"></view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\r\n\t\t<!-- 底部导航栏 -->\r\n\t\t<view class=\"flex-column-center\" style=\"position: fixed;bottom: -180px;\" :animation=\"animationData\">\r\n\t\t\t<view class=\"bottom-dh-char flex-row-around\" style=\"font-size: 55rpx;\">\r\n\t\t\t\t<text @click=\"contactUs\" class=\"yzb yzb-jiaoseqiehuan\"></text>\r\n\t\t\t\t<!-- vue无法使用软键盘\"发送\" -->\r\n\t\t\t\t<input\r\n\t\t\t\t\tv-model=\"msg\"\r\n\t\t\t\t\tclass=\"dh-input\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tstyle=\"background-color: #f0f0f0;\"\r\n\t\t\t\t\t@confirm=\"sendMsg\"\r\n\t\t\t\t\tconfirm-type=\"search\"\r\n\t\t\t\t\tplaceholder-class=\"my-neirong-sm\"\r\n\t\t\t\t\tplaceholder=\"请用一句话描述您的问题\"\r\n\t\t\t\t/>\r\n\t\t\t\t<view @click=\"sendMsg\" class=\"cu-tag bg-cyan round\">发送</view>\r\n\t\t\t\t<!-- <text @click=\"ckAdd\" class=\"yzb yzb-jia\"></text> -->\r\n\t\t\t</view>\r\n\t\t\t<!-- 附加栏(自定义) -->\r\n\t\t\t<view class=\"box-normal flex-row-around flex-wrap\">\r\n\t\t\t\t<view class=\"tb-text\">\r\n\t\t\t\t\t<view class=\"yzb yzb-yijianfankui\"></view>\r\n\t\t\t\t\t<text>问题反馈</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"tb-text\">\r\n\t\t\t\t\t<view class=\"yzb yzb-kefuguanli\"></view>\r\n\t\t\t\t\t<text>人工客服</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters } from 'vuex';\r\n// rpx和px的比率\r\nvar l;\r\n// 可用窗口高度\r\nvar wh;\r\n// 顶部空盒子的高度\r\nvar mgUpHeight;\r\n\r\nexport default {\r\n\tcomputed: {\r\n\t\t...mapState(['userInfo']),\r\n\t\t...mapGetters(['hasLogin'])\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmsgLoad: false,\r\n\t\t\tanData: {},\r\n\t\t\tanimationData: {},\r\n\t\t\tshowTow: false,\r\n\t\t\t// 消息体,定义机器人初次的消息(或者自定义出现时机)\r\n\t\t\t// my->谁发的消息 msg->消息文本 type->客服消息模板类型 questionList->快速获取问题答案的问题列表\r\n\t\t\tmsgList: [{ my: false, msg: '请问有什么问题可以帮助您?', type: 1, questionList: [] }],\r\n\t\t\tmsg: '',\r\n\t\t\tgo: 0,\r\n\t\t\tsrcollHeight: 0,\r\n\t\t\tlist: [],\r\n\t\t\tquery: {\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tlimit: 5,\r\n\t\t\t\tifCommon: 1\r\n\t\t\t},\r\n\t\t\tquery2: {\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tlimit: 50\r\n\t\t\t},\r\n\t\t\ttotalPage: 0,\r\n\t\t\tquestionList: []\r\n\t\t};\r\n\t},\r\n\r\n\tonLoad() {\r\n\t\tthis.initView();\r\n\t\tthis.getChatAskList();\r\n\t\tthis.getRobotLogList();\r\n\t},\r\n\r\n\tonPullDownRefresh() {\r\n\t\tconsole.log('onPullDownRefresh===');\r\n\t\tthis.query2.page++;\r\n\t\tthis.getRobotLogList();\r\n\t},\r\n\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 查询常见问题\r\n\t\t */\r\n\t\tasync getChatAskList() {\r\n\t\t\tlet res = await this.$apis.getChatAskList(this.query);\r\n\t\t\tconsole.log('getChatAskList===', res);\r\n\t\t\tif (res.data.length > 0) {\r\n\t\t\t\tthis.totalPage = Math.ceil(res.count / this.query.limit);\r\n\t\t\t\tthis.questionList = res.data;\r\n\t\t\t\tthis.msgList[0].questionList = res.data;\r\n\t\t\t\tthis.$forceUpdate();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync getRobotLogList() {\r\n\t\t\tif(!this.hasLogin){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet res = await this.$apis.getRobotLogList(this.query2);\r\n\t\t\tconsole.log('getRobotLogList===', res);\r\n\t\t\tif (res.data.length > 0) {\r\n\t\t\t\tlet data = res.data;\r\n\t\t\t\tdata = data.reverse();\r\n\t\t\t\tthis.msgList = this.msgList.concat(data);\r\n\t\t\t\t// 保证消息可见\r\n\t\t\t\tthis.msgGo();\r\n\t\t\t\tthis.$forceUpdate();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * 添加聊天记录\r\n\t\t */\r\n\t\tasync addRobotLog(msg) {\r\n\t\t\tif(this.hasLogin){\r\n\t\t\t\tlet res = await this.$apis.addRobotLog(msg);\r\n\t\t\t\tconsole.log('addRobotLog==', res);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tswitchAsks() {\r\n\t\t\tif (this.query.page < this.totalPage) {\r\n\t\t\t\tthis.query.page += 1;\r\n\t\t\t} else if (this.query.page == this.totalPage) {\r\n\t\t\t\tthis.query.page = 1;\r\n\t\t\t}\r\n\t\t\tthis.getChatAskList();\r\n\t\t},\r\n\r\n\t\tinitView() {\r\n\t\t\t// 如果需要缓存消息缓存msgList即可\r\n\t\t\t// 监听键盘拉起\r\n\t\t\t// 因为无法控制键盘拉起的速度,所以这里尽量以慢速处理\r\n\t\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\t\tconst query = uni.createSelectorQuery();\r\n\t\t\t\tquery\r\n\t\t\t\t\t.select('#okk')\r\n\t\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\t\t// 若消息体没有超过2倍的键盘则向下移动差值,防止遮住消息体\r\n\t\t\t\t\t\tvar up = res.height * 2 - data.height - l * 110;\r\n\t\t\t\t\t\tconsole.log(up);\r\n\t\t\t\t\t\tif (up > 0) {\r\n\t\t\t\t\t\t\t// 动态改变空盒子高度\r\n\t\t\t\t\t\t\tthis.msgMove(up, 300);\r\n\t\t\t\t\t\t\t// 记录改变的值,若不收回键盘且发送了消息用来防止消息过多被遮盖\r\n\t\t\t\t\t\t\tmgUpHeight = up;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 收回\r\n\t\t\t\t\t\tif (res.height == 0) {\r\n\t\t\t\t\t\t\tthis.msgMove(0, 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec();\r\n\t\t\t});\r\n\t\t\tvar query = uni.getSystemInfoSync();\r\n\r\n\t\t\tl = query.screenWidth / 750;\r\n\t\t\twh = query.windowHeight;\r\n\t\t\tthis.srcollHeight = query.windowHeight + 'px';\r\n\t\t},\r\n\r\n\t\t// 切换输入法时移动输入框(按照官方的上推页面的原理应该会自动适应不同的键盘高度-->官方bug)\r\n\t\tgoPag(kh) {\r\n\t\t\tthis.upTowmn(0, 250);\r\n\t\t\tif (this.keyHeight != 0) {\r\n\t\t\t\tif (kh - this.keyHeight > 0) {\r\n\t\t\t\t\tthis.upTowmn(this.keyHeight - kh, 250);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 移动顶部的空盒子\r\n\t\tmsgMove(x, t) {\r\n\t\t\tvar animation = uni.createAnimation({\r\n\t\t\t\tduration: t,\r\n\t\t\t\ttimingFunction: 'linear'\r\n\t\t\t});\r\n\r\n\t\t\tthis.animation = animation;\r\n\r\n\t\t\tanimation.height(x).step();\r\n\r\n\t\t\tthis.anData = animation.export();\r\n\t\t},\r\n\t\t// 保持消息体可见\r\n\t\tmsgGo() {\r\n\t\t\tconst query = uni.createSelectorQuery();\r\n\t\t\t// 延时100ms保证是最新的高度\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t// 获取消息体高度\r\n\t\t\t\tquery\r\n\t\t\t\t\t.select('#okk')\r\n\t\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\t\t// 如果超过scorll高度就滚动scorll\r\n\t\t\t\t\t\tif (data.height - wh > 0) {\r\n\t\t\t\t\t\t\tthis.go = data.height - wh;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 保证键盘第一次拉起时消息体能保持可见\r\n\t\t\t\t\t\tvar moveY = wh - data.height;\r\n\t\t\t\t\t\t// 超出页面则缩回空盒子\r\n\t\t\t\t\t\tif (moveY - mgUpHeight < 0) {\r\n\t\t\t\t\t\t\t// 小于0则视为0\r\n\t\t\t\t\t\t\tif (moveY < 0) {\r\n\t\t\t\t\t\t\t\tthis.msgMove(0, 200);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// 否则缩回盒子对应的高度\r\n\t\t\t\t\t\t\t\tthis.msgMove(moveY, 200);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec();\r\n\t\t\t}, 100);\r\n\t\t},\r\n\t\t// 回答问题的业务逻辑\r\n\t\tanswer(item) {\r\n\t\t\tconsole.log(item);\r\n\t\t\tlet ask = {\r\n\t\t\t\tmy: true,\r\n\t\t\t\tmsg: item.ask,\r\n\t\t\t\ttype: 3\r\n\t\t\t};\r\n\t\t\tthis.msgList.push(ask);\r\n\t\t\tthis.addRobotLog(ask);\r\n\t\t\tlet reply = {\r\n\t\t\t\tmy: false,\r\n\t\t\t\tmsg: item.reply,\r\n\t\t\t\ttype: 3\r\n\t\t\t};\r\n\t\t\tthis.msgList.push(reply);\r\n\t\t\tthis.addRobotLog(reply);\r\n\t\t\t// 保证消息可见\r\n\t\t\tthis.msgGo();\r\n\t\t},\r\n\t\tsendMsg() {\r\n\t\t\t// 消息为空不做任何操作\r\n\t\t\tif (this.msg == '') {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\t// 显示消息 msg消息文本,my鉴别是谁发的消息(不能用俩个消息数组循环,否则消息不会穿插)\r\n\t\t\tthis.msgList.push({ msg: this.msg, my: true });\r\n\t\t\tlet ask = {\r\n\t\t\t\tmy: true,\r\n\t\t\t\tmsg: this.msg,\r\n\t\t\t\ttype: 3\r\n\t\t\t};\r\n\t\t\tthis.addRobotLog(ask);\r\n\t\t\t// 保证消息可见\r\n\t\t\tthis.msgGo();\r\n\t\t\t// 回答问题\r\n\t\t\tthis.msgKf(this.msg);\r\n\t\t\t// 清除消息\r\n\t\t\tthis.msg = '';\r\n\t\t},\r\n\t\tasync msgKf(x) {\r\n\t\t\tthis.msgLoad = true;\r\n\t\t\tconsole.log(x);\r\n\t\t\tlet res = await this.$apis.getChatReply({ ask: x });\r\n\t\t\tconsole.log('getChatReply===', res);\r\n\t\t\tif (res == true) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// 取消loading\r\n\t\t\t\t\tthis.msgLoad = false;\r\n\t\t\t\t\tthis.msgList.push({\r\n\t\t\t\t\t\tmy: false,\r\n\t\t\t\t\t\tmsg: '我不懂您在说什么哦',\r\n\t\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t\tquestionList: this.questionList\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet reply = {\r\n\t\t\t\t\t\tmy: false,\r\n\t\t\t\t\t\tmsg: '我不懂您在说什么哦',\r\n\t\t\t\t\t\ttype: 3\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.addRobotLog(reply);\r\n\t\t\t\t\t// this.msgList.push({ my: false, msg: '单消息模板', type: -1 });\r\n\t\t\t\t\t// this.msgList.push({\r\n\t\t\t\t\t// \tmy: false,\r\n\t\t\t\t\t// \tmsg: '根据您的问题,已为您匹配了下列问题(多个答案模板)',\r\n\t\t\t\t\t// \ttype: 2,\r\n\t\t\t\t\t// \tquestionList: ['如何注销用户', '我想了解业务流程', '手机号如何更换']\r\n\t\t\t\t\t// });\r\n\t\t\t\t\tthis.msgGo();\r\n\t\t\t\t}, 1000);\r\n\t\t\t} else {\r\n\t\t\t\tthis.msgLoad = false;\r\n\t\t\t\tthis.msgList.push({\r\n\t\t\t\t\tmy: false,\r\n\t\t\t\t\tmsg: res.reply,\r\n\t\t\t\t\ttype: 3\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// 保证消息可见\r\n\t\t\tthis.msgGo();\r\n\t\t},\r\n\t\t// 不建议输入框聚焦时操作此动画\r\n\t\tckAdd() {\r\n\t\t\tif (!this.showTow) {\r\n\t\t\t\tthis.upTowmn(-180, 350);\r\n\t\t\t} else {\r\n\t\t\t\tthis.upTowmn(0, 200);\r\n\t\t\t}\r\n\t\t\tthis.showTow = !this.showTow;\r\n\t\t},\r\n\r\n\t\tcontactUs() {\r\n\t\t\tthis.$mRouter.push({\r\n\t\t\t\troute: this.$mRoutesConfig.contactUs\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\thideKey() {\r\n\t\t\tuni.hideKeyboard();\r\n\t\t},\r\n\t\t// 拉起/收回附加栏\r\n\t\tupTowmn(x, t) {\r\n\t\t\tvar animation = uni.createAnimation({\r\n\t\t\t\tduration: t,\r\n\t\t\t\ttimingFunction: 'ease'\r\n\t\t\t});\r\n\r\n\t\t\tthis.animation = animation;\r\n\r\n\t\t\tanimation.translateY(x).step();\r\n\r\n\t\t\tthis.animationData = animation.export();\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n/* @import \"./main.css\"; */\r\n\r\nbody {\r\n\tbackground-color: #f1f1f1;\r\n\tfont-size: 28upx;\r\n\tcolor: #333333;\r\n\tfont-family: Helvetica Neue, Helvetica, sans-serif;\r\n}\r\n\r\n.round {\r\n\tborder-radius: 10upx;\r\n\tpadding: 6upx 15upx;\r\n}\r\n\r\n.flex {\r\n\tdisplay: flex;\r\n}\r\n.justify-end {\r\n\tjustify-content: flex-end;\r\n}\r\n.align-start {\r\n\talign-items: flex-start;\r\n}\r\n\r\n.padding-top-sm {\r\n\tpadding-top: 20upx;\r\n}\r\n\r\n.padding-top {\r\n\tpadding-top: 20upx;\r\n}\r\n\r\n.padding-right {\r\n\tpadding-right: 20upx;\r\n}\r\n\r\n.margin-left {\r\n\tmargin-left: 20upx;\r\n}\r\n\r\n.margin-top {\r\n\tmargin-top: 20upx;\r\n}\r\n\r\n.bg-cyan {\r\n\tbackground-color: $main-color;\r\n\tcolor: #ffffff;\r\n}\r\n\r\n.flex-column-center {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n.flex-column-between {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n.flex-column-start {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n}\r\n\r\n.flex-row-start {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\talign-items: center;\r\n}\r\n\r\n.flex-row-around {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tjustify-content: space-around;\r\n\talign-items: center;\r\n}\r\n\r\n.flex-row-between {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n\r\n.flex-row-center {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n.flex-row-between {\r\n\tdisplay: flex;\r\n\tflex-direction: row;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n\r\n.bottom-dh-char {\r\n\tbackground-color: #f9f9f9;\r\n\t/* width: 750rpx; */\r\n\theight: 110rpx;\r\n\tpadding: 0 20upx;\r\n\twidth: 100%;\r\n\tbox-sizing: border-box;\r\n}\r\n.center-box {\r\n\twidth: 720rpx;\r\n\tpadding-left: 25rpx;\r\n}\r\n\r\n.my-neirong {\r\n\tfont-size: 26rpx;\r\n\tcolor: #6d6d6d;\r\n}\r\n.my-neirong-sm {\r\n\tfont-size: 23rpx;\r\n\tcolor: #838383;\r\n}\r\n\r\n.hui-box {\r\n\twidth: 750rpx;\r\n\theight: 100%;\r\n}\r\n.dh-input {\r\n\twidth: 76%;\r\n\theight: 65rpx;\r\n\tborder-radius: 30rpx;\r\n\tpadding-left: 15rpx;\r\n\tbackground-color: #ffffff;\r\n\tfont-size: 30upx;\r\n}\r\n.box-normal {\r\n\twidth: 750rpx;\r\n\theight: 180px;\r\n\tbackground-color: #ffffff;\r\n}\r\n.tb-text {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n}\r\n.tb-text view {\r\n\tfont-size: 65rpx;\r\n}\r\n.tb-text text {\r\n\tfont-size: 25rpx;\r\n\tcolor: #737373;\r\n\tmargin-top: 10upx;\r\n}\r\n.chat-img {\r\n\tborder-radius: 50%;\r\n\twidth: 70rpx;\r\n\theight: 70rpx;\r\n\tbackground-color: #f7f7f7;\r\n}\r\n\r\n.padding-chat {\r\n\tpadding: 17rpx 20rpx;\r\n}\r\n.tb-nv {\r\n\twidth: 50rpx;\r\n\theight: 50rpx;\r\n}\r\n.yzb-jia {\r\n\tfont-size: 50upx;\r\n\ttext-align: center;\r\n\tcolor: #666;\r\n}\r\n.yzb-jiaoseqiehuan {\r\n\tfont-size: 45upx;\r\n\ttext-align: center;\r\n\tcolor: #f0ad4e;\r\n}\r\n\r\n.yzb-yijianfankui {\r\n\tcolor: #f0ad4e;\r\n}\r\n.yzb-kefuguanli {\r\n\tcolor: #f0ad4e;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./robot.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./robot.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1714040486931\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}