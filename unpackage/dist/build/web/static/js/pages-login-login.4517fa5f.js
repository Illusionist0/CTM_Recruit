(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"09bd":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[e.canIUse?i("v-uni-view",{staticClass:"wx-auth"},[i("v-uni-view",{staticClass:"top"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-image",{attrs:{src:n("8012")}})],1),i("v-uni-view",{staticClass:"btn"},[1==e.isGetPhone?i("v-uni-button",{staticClass:"btn-get-phone",attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(t){arguments[0]=t=e.$handleEvent(t),e.getPhoneNumber.apply(void 0,arguments)}}},[e._v("一键绑定手机号登录")]):i("v-uni-button",{staticClass:"btn-auth",attrs:{withCredentials:"true"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.wxGetUserInfo.apply(void 0,arguments)}}},[e._v("微信一键登录/注册")])],1)],1),i("v-uni-view",{staticClass:"bottom"},[i("v-uni-view",{staticClass:"other-login"},[i("v-uni-text",{staticClass:"title"},[e._v("其他登录方式")]),i("v-uni-text",{staticClass:"yzb yzb-shoujisel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.phoneLogin()}}})],1),i("v-uni-view",{staticClass:"agreement"},[i("v-uni-radio-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.radioGroup.apply(void 0,arguments)}}},[i("v-uni-radio",{staticStyle:{transform:"scale(0.72)"},attrs:{color:"#12ae85",value:1,checked:e.radioValue}})],1),i("v-uni-view",{staticClass:"agreement2"},[e._v("已阅读并同意"),i("v-uni-text",{staticClass:"agreement-text",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toTerms.apply(void 0,arguments)}}},[e._v("用户协议")]),e._v("和"),i("v-uni-text",{staticClass:"agreement-text",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toPrivacy.apply(void 0,arguments)}}},[e._v("隐私政策")])],1)],1)],1)],1):i("v-uni-view",[e._v("请升级微信版本")])],1)},o=[]},8012:function(e,t,n){e.exports=n.p+"static/logo.png"},a43d:function(e,t,n){"use strict";var i=n("b4e2"),o=n.n(i);o.a},ab8b:function(e,t,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("14d9");var o=i(n("f07e")),a=i(n("c964")),r={data:function(){return{canIUse:uni.canIUse("button.open-type.getUserInfo"),bindUserInfo:null,radioValue:0,isGetPhone:!1}},onShow:function(){},methods:{wxGetUserInfo:function(e){var t=this;uni.getUserProfile({desc:"完善用户信息",success:function(e){uni.login({provider:"weixin",success:function(n){t.bindUserInfo=JSON.parse(e.rawData),t.getOpenId(n.code)}})},fail:function(e){console.log(e),uni.showToast({title:"您取消了授权,登录失败",icon:"none"})}})},getOpenId:function(e){var t=this;return(0,a.default)((0,o.default)().mark((function n(){var i;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$apis.getOpenId({code:e});case 2:i=n.sent,t.openid=i.openid,t.session_key=i.session_key,t.$store.commit("SET_OPENID",i.openId),uni.setStorage({key:"session_key",data:i.session_key}),null!=i&&t.xcxLogin(i.openId);case 8:case"end":return n.stop()}}),n)})))()},bindGetUserInfo:function(e){if(1!=this.radioValue)return uni.showToast({title:"请勾选用户协议",icon:"none",position:"bottom"}),!1;if(e.detail.userInfo){this.bindUserInfo=e.detail.userInfo,this.isHide=!0,this.isPhoneShow=!0,uni.showLoading({title:"授权登录中···"}),this.wxAuth()}else uni.showModal({title:"警告",content:"您点击了拒绝授权，将无法进入小程序，请授权之后再进入!!!",showCancel:!1,confirmText:"返回授权",success:function(e){e.confirm&&console.log("用户点击了“返回授权”")}})},xcxLogin:function(e){var t=this;return(0,a.default)((0,o.default)().mark((function n(){var i,a;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t,i={openid:e,avatar:t.bindUserInfo.avatarUrl,nickName:t.bindUserInfo.nickName},n.next=4,t.$apis.xcxUserLogin(i);case 4:a=n.sent,console.log("xcxUserLogin===",a),"账号不存在"!=a&&"未绑定手机号"!=a?(t.$store.commit("SET_USERINFO",a.currMember||{}),t.$store.commit("SET_TOKEN",a.token),uni.navigateBack({delta:1})):(console.log("绑定手机号"),t.isGetPhone=!0);case 7:case"end":return n.stop()}}),n)})))()},bindPhoneForWx:function(e,t){var n=this;return(0,a.default)((0,o.default)().mark((function i(){var a,r;return(0,o.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a={openid:uni.getStorageSync("openId"),keyStr:uni.getStorageSync("session_key"),ivStr:e,encDataStr:t,avatar:n.bindUserInfo.avatarUrl,nickName:n.bindUserInfo.nickName},i.next=3,n.$apis.bindPhoneForWx(a);case 3:r=i.sent,r&&(n.$store.commit("SET_USERINFO",r.currMember||{}),n.$store.commit("SET_TOKEN",r.token),uni.navigateBack({delta:1})),console.log("bindPhoneForWx",r);case 6:case"end":return i.stop()}}),i)})))()},getPhoneNumber:function(e){console.log("getPhoneNumber",e);this.bindPhoneForWx(e.detail.iv,e.detail.encryptedData)},phoneLogin:function(){this.$mRouter.push({route:this.$mRoutesConfig.loginPwd})},cancle:function(){uni.navigateBack({delta:1})},updateMember:function(){if(null!=this.bindUserInfo){var e={avatar:this.bindUserInfo.avatarUrl,name:this.bindUserInfo.nickName,sex:this.bindUserInfo.gender,nickName:this.bindUserInfo.nickName};api.getUpdateMemberInfo(e,(function(e){200==e.data.code&&uni.showToast({title:e.data.message})}))}},radioGroup:function(e){this.radioValue=e.detail.value},toTerms:function(){this.$mRouter.push({route:this.$mRoutesConfig.terms})},toPrivacy:function(){this.$mRouter.push({route:this.$mRoutesConfig.privacy})}}};t.default=r},b4e2:function(e,t,n){var i=n("d5d5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=n("4f06").default;o("5d36cefb",i,!0,{sourceMap:!1,shadowMode:!1})},bbcb:function(e,t,n){"use strict";n.r(t);var i=n("ab8b"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},d5d5:function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 背景颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* 微信授权 */.wx-auth[data-v-605d2cf6]{width:100%}.wx-auth .header[data-v-605d2cf6]{display:flex;align-items:center;justify-content:center;text-align:center;width:100%;height:%?450?%}.wx-auth .header uni-image[data-v-605d2cf6]{width:%?260?%;height:%?260?%}.wx-auth .content2[data-v-605d2cf6]{padding:%?30?% %?80?%}.wx-auth .content2 uni-text[data-v-605d2cf6]{display:block;color:#666;margin-top:%?40?%}.wx-auth .btn[data-v-605d2cf6]{display:flex;flex-direction:column;justify-content:center;align-items:center}.wx-auth .btn-auth[data-v-605d2cf6]{border-radius:%?20?%;margin-top:%?50?%;font-size:%?35?%;width:90%;background-color:#01beff;color:#fff}.wx-auth .btn-get-phone[data-v-605d2cf6]{border-radius:%?20?%;margin-top:%?50?%;font-size:%?35?%;width:90%;background-color:#01beff;color:#fff}.wx-auth .cancel-login[data-v-605d2cf6]{border-radius:%?15?%;margin:%?70?% %?20?% %?50?% %?50?%;font-size:%?35?%;background-color:#eee;width:30%}.bottom[data-v-605d2cf6]{display:flex;width:100%;flex-direction:column;justify-content:center;align-items:center;position:fixed;bottom:%?20?%}.bottom .other-login[data-v-605d2cf6]{display:flex;flex-direction:column;align-items:center}.bottom .other-login .title[data-v-605d2cf6]{color:#666}.bottom .other-login .yzb-shoujisel[data-v-605d2cf6]{font-size:%?100?%;color:#01beff}.bottom .agreement[data-v-605d2cf6]{margin-top:%?50?%;display:flex;flex-direction:row;align-items:center}.bottom .agreement .agreement2[data-v-605d2cf6]{font-size:%?28?%;color:#9b9b9b}.bottom .agreement .agreement-text[data-v-605d2cf6]{text-decoration:underline;color:#12ae85;padding:0 %?10?%;font-size:%?28?%}',""]),e.exports=t},ed89:function(e,t,n){"use strict";n.r(t);var i=n("09bd"),o=n("bbcb");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("a43d");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"605d2cf6",null,!1,i["a"],void 0);t["default"]=s.exports}}]);