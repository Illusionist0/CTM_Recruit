(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"1c02":function(t,e,n){"use strict";var i=n("7cf7"),o=n.n(i);o.a},2245:function(t,e,n){"use strict";n.r(e);var i=n("932d"),o=n("b89b");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("1c02");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"605d2cf6",null,!1,i["a"],void 0);e["default"]=s.exports},"7cf7":function(t,e,n){var i=n("c3f8");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=n("4f06").default;o("dde3a906",i,!0,{sourceMap:!1,shadowMode:!1})},"86c3":function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("14d9");var o=i(n("f07e")),a=i(n("c964")),r={data:function(){return{canIUse:uni.canIUse("button.open-type.getUserInfo"),bindUserInfo:null,radioValue:0,isGetPhone:!1}},onShow:function(){},methods:{wxGetUserInfo:function(t){var e=this;uni.getUserProfile({desc:"完善用户信息",success:function(t){uni.login({provider:"weixin",success:function(n){e.bindUserInfo=JSON.parse(t.rawData),e.getOpenId(n.code)}})},fail:function(t){console.log(t),uni.showToast({title:"您取消了授权,登录失败",icon:"none"})}})},getOpenId:function(t){var e=this;return(0,a.default)((0,o.default)().mark((function n(){var i;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$apis.getOpenId({code:t});case 2:i=n.sent,e.openid=i.openid,e.session_key=i.session_key,e.$store.commit("SET_OPENID",i.openId),uni.setStorage({key:"session_key",data:i.session_key}),null!=i&&e.xcxLogin(i.openId);case 8:case"end":return n.stop()}}),n)})))()},bindGetUserInfo:function(t){if(1!=this.radioValue)return uni.showToast({title:"请勾选用户协议",icon:"none",position:"bottom"}),!1;if(t.detail.userInfo){this.bindUserInfo=t.detail.userInfo,this.isHide=!0,this.isPhoneShow=!0,uni.showLoading({title:"授权登录中···"}),this.wxAuth()}else uni.showModal({title:"警告",content:"您点击了拒绝授权，将无法进入小程序，请授权之后再进入!!!",showCancel:!1,confirmText:"返回授权",success:function(t){t.confirm&&console.log("用户点击了“返回授权”")}})},xcxLogin:function(t){var e=this;return(0,a.default)((0,o.default)().mark((function n(){var i,a;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e,i={openid:t,avatar:e.bindUserInfo.avatarUrl,nickName:e.bindUserInfo.nickName},n.next=4,e.$apis.xcxUserLogin(i);case 4:a=n.sent,console.log("xcxUserLogin===",a),"账号不存在"!=a&&"未绑定手机号"!=a?(e.$store.commit("SET_USERINFO",a.currMember||{}),e.$store.commit("SET_TOKEN",a.token),uni.navigateBack({delta:1})):(console.log("绑定手机号"),e.isGetPhone=!0);case 7:case"end":return n.stop()}}),n)})))()},bindPhoneForWx:function(t,e){var n=this;return(0,a.default)((0,o.default)().mark((function i(){var a,r;return(0,o.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a={openid:uni.getStorageSync("openId"),keyStr:uni.getStorageSync("session_key"),ivStr:t,encDataStr:e,avatar:n.bindUserInfo.avatarUrl,nickName:n.bindUserInfo.nickName},i.next=3,n.$apis.bindPhoneForWx(a);case 3:r=i.sent,r&&(n.$store.commit("SET_USERINFO",r.currMember||{}),n.$store.commit("SET_TOKEN",r.token),uni.navigateBack({delta:1})),console.log("bindPhoneForWx",r);case 6:case"end":return i.stop()}}),i)})))()},getPhoneNumber:function(t){console.log("getPhoneNumber",t);this.bindPhoneForWx(t.detail.iv,t.detail.encryptedData)},phoneLogin:function(){this.$mRouter.push({route:this.$mRoutesConfig.loginPwd})},cancle:function(){uni.navigateBack({delta:1})},updateMember:function(){if(null!=this.bindUserInfo){var t={avatar:this.bindUserInfo.avatarUrl,name:this.bindUserInfo.nickName,sex:this.bindUserInfo.gender,nickName:this.bindUserInfo.nickName};api.getUpdateMemberInfo(t,(function(t){200==t.data.code&&uni.showToast({title:t.data.message})}))}},radioGroup:function(t){this.radioValue=t.detail.value},toTerms:function(){this.$mRouter.push({route:this.$mRoutesConfig.terms})},toPrivacy:function(){this.$mRouter.push({route:this.$mRoutesConfig.privacy})}}};e.default=r},"932d":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[t.canIUse?i("v-uni-view",{staticClass:"wx-auth"},[i("v-uni-view",{staticClass:"top"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-image",{attrs:{src:n("bea1")}})],1),i("v-uni-view",{staticClass:"btn"},[1==t.isGetPhone?i("v-uni-button",{staticClass:"btn-get-phone",attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(e){arguments[0]=e=t.$handleEvent(e),t.getPhoneNumber.apply(void 0,arguments)}}},[t._v("一键绑定手机号登录")]):i("v-uni-button",{staticClass:"btn-auth",attrs:{withCredentials:"true"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.wxGetUserInfo.apply(void 0,arguments)}}},[t._v("微信一键登录/注册")])],1)],1),i("v-uni-view",{staticClass:"bottom"},[i("v-uni-view",{staticClass:"other-login"},[i("v-uni-text",{staticClass:"title"},[t._v("其他登录方式")]),i("v-uni-text",{staticClass:"yzb yzb-shoujisel",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.phoneLogin()}}})],1),i("v-uni-view",{staticClass:"agreement"},[i("v-uni-radio-group",{on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.radioGroup.apply(void 0,arguments)}}},[i("v-uni-radio",{staticStyle:{transform:"scale(0.72)"},attrs:{color:"#12ae85",value:1,checked:t.radioValue}})],1),i("v-uni-view",{staticClass:"agreement2"},[t._v("已阅读并同意"),i("v-uni-text",{staticClass:"agreement-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toTerms.apply(void 0,arguments)}}},[t._v("用户协议")]),t._v("和"),i("v-uni-text",{staticClass:"agreement-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toPrivacy.apply(void 0,arguments)}}},[t._v("隐私政策")])],1)],1)],1)],1):i("v-uni-view",[t._v("请升级微信版本")])],1)},o=[]},b89b:function(t,e,n){"use strict";n.r(e);var i=n("86c3"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},bea1:function(t,e,n){t.exports=n.p+"static/logo.png"},c3f8:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 背景颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* 微信授权 */.wx-auth[data-v-605d2cf6]{width:100%}.wx-auth .header[data-v-605d2cf6]{display:flex;align-items:center;justify-content:center;text-align:center;width:100%;height:%?450?%}.wx-auth .header uni-image[data-v-605d2cf6]{width:%?260?%;height:%?260?%}.wx-auth .content2[data-v-605d2cf6]{padding:%?30?% %?80?%}.wx-auth .content2 uni-text[data-v-605d2cf6]{display:block;color:#666;margin-top:%?40?%}.wx-auth .btn[data-v-605d2cf6]{display:flex;flex-direction:column;justify-content:center;align-items:center}.wx-auth .btn-auth[data-v-605d2cf6]{border-radius:%?20?%;margin-top:%?50?%;font-size:%?35?%;width:90%;background-color:#26cd8c;color:#fff}.wx-auth .btn-get-phone[data-v-605d2cf6]{border-radius:%?20?%;margin-top:%?50?%;font-size:%?35?%;width:90%;background-color:#26cd8c;color:#fff}.wx-auth .cancel-login[data-v-605d2cf6]{border-radius:%?15?%;margin:%?70?% %?20?% %?50?% %?50?%;font-size:%?35?%;background-color:#eee;width:30%}.bottom[data-v-605d2cf6]{display:flex;width:100%;flex-direction:column;justify-content:center;align-items:center;position:fixed;bottom:%?20?%}.bottom .other-login[data-v-605d2cf6]{display:flex;flex-direction:column;align-items:center}.bottom .other-login .title[data-v-605d2cf6]{color:#666}.bottom .other-login .yzb-shoujisel[data-v-605d2cf6]{font-size:%?100?%;color:#26cd8c}.bottom .agreement[data-v-605d2cf6]{margin-top:%?50?%;display:flex;flex-direction:row;align-items:center}.bottom .agreement .agreement2[data-v-605d2cf6]{font-size:%?28?%;color:#9b9b9b}.bottom .agreement .agreement-text[data-v-605d2cf6]{text-decoration:underline;color:#12ae85;padding:0 %?10?%;font-size:%?28?%}',""]),t.exports=e}}]);